<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Physical Background · DeconvOptim.jl</title><meta name="title" content="Physical Background · DeconvOptim.jl"/><meta property="og:title" content="Physical Background · DeconvOptim.jl"/><meta property="twitter:title" content="Physical Background · DeconvOptim.jl"/><meta name="description" content="Documentation for DeconvOptim.jl."/><meta property="og:description" content="Documentation for DeconvOptim.jl."/><meta property="twitter:description" content="Documentation for DeconvOptim.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="DeconvOptim.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DeconvOptim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">DeconvOptim.jl</a></li><li><span class="tocitem">Workflow</span><ul><li><a class="tocitem" href="../../workflow/basic_workflow/">Basic Workflow</a></li><li><a class="tocitem" href="../../workflow/changing_regularizers/">Changing Regularizers: 2D Example</a></li><li><a class="tocitem" href="../../workflow/changing_loss/">Changing Loss Function: 2D Example</a></li><li><a class="tocitem" href="../../workflow/3D_dataset/">3D Dataset</a></li><li><a class="tocitem" href="../../workflow/cuda/">CUDA</a></li><li><a class="tocitem" href="../../workflow/flexible_invert/">More complex Invert</a></li><li><a class="tocitem" href="../../workflow/performance_tips/">Performance Tips</a></li></ul></li><li><span class="tocitem">Background</span><ul><li class="is-active"><a class="tocitem" href>Physical Background</a><ul class="internal"><li><a class="tocitem" href="#Forward-Model"><span>Forward Model</span></a></li><li><a class="tocitem" href="#Noise-Model"><span>Noise Model</span></a></li></ul></li><li><a class="tocitem" href="../mathematical_optimization/">Mathematical Optimization</a></li><li><a class="tocitem" href="../loss_functions/">Loss functions</a></li><li><a class="tocitem" href="../regularizer/">Regularizer</a></li></ul></li><li><span class="tocitem">Function references</span><ul><li><a class="tocitem" href="../../function_references/deconvolution/">Deconvolution</a></li><li><a class="tocitem" href="../../function_references/loss/">Loss Functions</a></li><li><a class="tocitem" href="../../function_references/mapping/">Mapping Functions</a></li><li><a class="tocitem" href="../../function_references/regularizer/">Regularizers</a></li><li><a class="tocitem" href="../../function_references/utils/">Util functions</a></li><li><a class="tocitem" href="../../function_references/analysis/">Analysis functions</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Background</a></li><li class="is-active"><a href>Physical Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Physical Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/roflmaostc/DeconvOptim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/roflmaostc/DeconvOptim.jl/blob/master/docs/src/background/physical_background.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Physical-Background"><a class="docs-heading-anchor" href="#Physical-Background">Physical Background</a><a id="Physical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Background" title="Permalink"></a></h1><p>We want to provide some physical background to the process of (de)convolution in optics. Optical systems like brightfield microscopes can only collect a certain amount of light emitted by a specimen. This effect (diffraction) leads to a blurred image of that specimen. Mathematically the lens has a certain frequency support. Within that frequency range, transmission of light is supported. Information (light) outside of this frequency support (equivalent to high frequency information) is lost. In the following picture we can see several curves in the frequency domain.  The orange line is a artificial object with a constant frequency spectrum (delta peak in real space). If such a delta peak is transferred through an optical lens, in real space the object is convolved with the point spread function (PSF).  In frequency space such a convolution is a multiplication of the OTF (OTF is the Fourier transform of the PSF) and the frequency spectrum of the object. The green dotted curve is the captured image after transmission through the system. Additionally some noise was introduced which can be recognized through some bumps outside of the OTF support. <img src="../../assets/ideal_frequencies.png" alt="Frequency spectrum"/></p><h2 id="Forward-Model"><a class="docs-heading-anchor" href="#Forward-Model">Forward Model</a><a id="Forward-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-Model" title="Permalink"></a></h2><p>Mathematically an ideal imaging process of specimen emitting incoherent light by a lens (or any optical system in general) can be described as:</p><p class="math-container">\[Y(r) = (S * \text{PSF})(r)\]</p><p>where <span>$*$</span> being a convolution operation, <span>$r$</span> being the position, <span>$S$</span> being the sample and <span>$\text{PSF}$</span> being the point spread function of the system. One can also introduce a background term <span>$b$</span> independent of the position, which models a constant signal offset of the imaging sensor:</p><p class="math-container">\[Y(r) = (S * \text{PSF})(r) + b\]</p><p>In frequency space (Fourier transforming the above equation) the equation with <span>$b=0$</span> is:</p><p class="math-container">\[\tilde Y(k) = (\tilde S \cdot \tilde{\text{PSF}})(k),\]</p><p>where <span>$k$</span> is the spatial frequency and <span>$\cdot$</span> represents term-wise multiplication (this is due to the <a href="https://en.wikipedia.org/wiki/Convolution_theorem">convolution theorem of the Fourier transform</a>). From that equation it is clear why the green and blue line in the plot look very similar. The reason is, that the orange line is constant and we basically multiply the OTF with the orange line. </p><h2 id="Noise-Model"><a class="docs-heading-anchor" href="#Noise-Model">Noise Model</a><a id="Noise-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Noise-Model" title="Permalink"></a></h2><p>However, the physical description (forward model) should also contain a noise term to reflect the measurement process in reality more accurately. </p><p class="math-container">\[Y(r) = (S * \text{PSF})(r) + N(r) = \mu(r) + N(r)\]</p><p>where <span>$N$</span> being a noise term. In fluorescence microscopy the dominant noise is usually <em>Poisson shot noise</em> (see [<a href="../../references/#Mertz:2019">1</a>]). The origin of that noise is the quantum nature of photons. Since the measurement process spans over a time T only a discrete number of photons is detected (in real experiment the amount of photons per pixel is usually in the order of <span>$10^1 - 10^3$</span>). Note that this noise is not introduced by the sensor and is just a effect due to quantum nature of light.  We can interpret every sensor pixel as a discrete random variable <span>$X$</span>. The expected value of that pixel would be <span>$\mu(r)$</span> (true specimen convolved with the <span>$\text{PSF})$</span>. Due to noise, the systems measures randomly a signal for <span>$X$</span> according to the Poisson distribution:</p><p class="math-container">\[f(y, \mu) = \frac{\mu^y \exp(-\mu)}{\Gamma(y + 1)}\]</p><p>where <span>$f$</span> is the probability density distribution, <span>$y$</span> the measured value of the sensor, <span>$\mu$</span> the expected value and <span>$\Gamma$</span> the generalized factorial function (<a href="https://en.wikipedia.org/wiki/Gamma_function">Gamma function</a>).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../workflow/performance_tips/">« Performance Tips</a><a class="docs-footer-nextpage" href="../mathematical_optimization/">Mathematical Optimization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 1 February 2024 12:20">Thursday 1 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
